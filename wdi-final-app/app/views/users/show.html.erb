<%= render "tabs" %>

<div class="user-page" id="user-show-home">



<div>
Your total mileage: <span id="user-total"><%= @user.logs.sum(:mileage) %></span> miles
</div>
<div>
	<%= @user.logs.sum(:mileage) %>
</div>
	<%= link_to "See all teams", teams_path %>
	<br>
	<%= link_to "See my teams", user_teams_path(@user) %>
	<br>
	<%= link_to "Add a new log", new_log_path(@user) %>

	<!-- HighCharts -->
<div id="user-chart-container" style="width:100%; height:400px;"></div>
</div>

<%= render :partial => 'logs/new', :object => @log %>

<script>

var userFirstName = $('#user-first-name').text();

var userTotal = 0;
$('#user-total').each(function() {
	userTotal += +$(this).text()||0;
});
console.log(userTotal);

// Highcharts
$(function () {
    Highcharts.chart('user-chart-container', {
        chart: {
            type: 'bar'
        },
        title: {
            text: 'My Total Mileage'
        },
        xAxis: {
            categories: null
        },
        yAxis: {
        	min: 0,
        	max: userTotal + 5,
            title: {
                text: 'Miles'
            }
        },
        legend: {
            reversed: false
        },
        plotOptions: {
            bar: {
                dataLabels: {
                	enabled: true
                }
            }
        },
        series: [{
            name: [userFirstName],
            data: [userTotal]
        }]
    });
});

</script>
